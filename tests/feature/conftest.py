import pandas as pd
import pytest


@pytest.fixture
def pri_consumer():
    data = {
        "price_id": [1, 2, 3],
        "consumer_id": [1, 2, 3],
        "web_id": [1, 2, 3],
        "company_name": ["A", "B", "C"],
        "symbol": ["A", "B", "C"],
        "date": pd.to_datetime(["2021-01-01", "2021-01-02", "2021-01-03"]),
        "spend": [100, 200, 300],
    }
    return pd.DataFrame(data)


@pytest.fixture
def pri_prices():
    data = {
        "price_id": [1, 2, 3],
        "consumer_id": [1, 2, 3],
        "web_id": [1, 2, 3],
        "company_name": ["A", "B", "C"],
        "symbol": ["A", "B", "C"],
        "date": pd.to_datetime(["2021-01-01", "2021-01-02", "2021-01-03"]),
        "price": [100, 200, 300],
    }
    return pd.DataFrame(data)


@pytest.fixture
def pri_web():
    data = {
        "price_id": [1, 2, 3],
        "consumer_id": [1, 2, 3],
        "web_id": [1, 2, 3],
        "company_name": ["A", "B", "C"],
        "symbol": ["A", "B", "C"],
        "date": pd.to_datetime(["2021-01-01", "2021-01-02", "2021-01-03"]),
        "web_data": [100, 200, 300],
    }
    return pd.DataFrame(data)


@pytest.fixture
def master_df():
    data = {
        "company_name": ["A", "B", "C"],
        "symbol": ["A", "B", "C"],
        "date": pd.to_datetime(["2021-01-01", "2021-01-02", "2021-01-03"]),
        "spend": [100, 200, 300],
        "price": [100, 200, 300],
        "web_data": [100, 200, 300],
    }
    return pd.DataFrame(data)


@pytest.fixture
def master_df_agg():
    data = {
        "date": pd.to_datetime(
            [
                "2021-01-31",
                "2021-03-31",
                "2021-01-03",
                "2021-12-31",
                "2021-01-31",
                "2021-03-31",
                "2021-01-03",
                "2021-12-31",
                "2021-01-31",
                "2021-03-31",
                "2021-01-03",
                "2021-12-31",
            ]
        ),
        "company_name": ["A", "A", "A", "A", "B", "B", "B", "B", "C", "C", "C", "C"],
        "symbol": ["A", "A", "A", "A", "B", "B", "B", "B", "C", "C", "C", "C"],
        "spend_mean": [
            100.0,
            100.0,
            100.0,
            100.0,
            200.0,
            200.0,
            200.0,
            200.0,
            300.0,
            300.0,
            300.0,
            300.0,
        ],
        "spend_sum": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "spend_min": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "spend_max": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "price_mean": [
            100.0,
            100.0,
            100.0,
            100.0,
            200.0,
            200.0,
            200.0,
            200.0,
            300.0,
            300.0,
            300.0,
            300.0,
        ],
        "price_sum": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "price_min": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "price_max": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "web_data_mean": [
            100.0,
            100.0,
            100.0,
            100.0,
            200.0,
            200.0,
            200.0,
            200.0,
            300.0,
            300.0,
            300.0,
            300.0,
        ],
        "web_data_sum": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "web_data_min": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "web_data_max": [100, 100, 100, 100, 200, 200, 200, 200, 300, 300, 300, 300],
        "agg_freq": ["M", "Q", "W", "Y", "M", "Q", "W", "Y", "M", "Q", "W", "Y"],
        "year": [
            2021,
            2021,
            2021,
            2021,
            2021,
            2021,
            2021,
            2021,
            2021,
            2021,
            2021,
            2021,
        ],
        "quarter": [1, 1, 1, 4, 1, 1, 1, 4, 1, 1, 1, 4],
        "month": [1, 3, 1, 12, 1, 3, 1, 12, 1, 3, 1, 12],
        "week": [
            "05",
            "13",
            "01",
            "52",
            "05",
            "13",
            "01",
            "52",
            "05",
            "13",
            "01",
            "52",
        ],
        "dt_label": [
            "2021 M1",
            "2021 Q1",
            "2021 W01",
            "2021",
            "2021 M1",
            "2021 Q1",
            "2021 W01",
            "2021",
            "2021 M1",
            "2021 Q1",
            "2021 W01",
            "2021",
        ],
    }
    return pd.DataFrame(data)
